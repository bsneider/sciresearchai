{
  "protection_hooks": {
    "pre_task": [
      {
        "name": "scope_validation",
        "description": "Verify task remains within defined boundaries",
        "implementation": "check_scope_boundaries(task_definition, current_changes)"
      },
      {
        "name": "dependency_check",
        "description": "Ensure task dependencies are satisfied",
        "implementation": "verify_task_dependencies(task_id, completed_tasks)"
      },
      {
        "name": "api_rate_limit_check",
        "description": "Validate external API usage respects rate limits",
        "implementation": "check_api_rate_limits(planned_api_calls)"
      }
    ],
    "during_task": [
      {
        "name": "file_change_monitor",
        "description": "Track file changes and prevent scope creep",
        "implementation": "monitor_file_changes(max_files: task.max_file_changes)"
      },
      {
        "name": "api_call_validator",
        "description": "Validate external API calls against approved list",
        "implementation": "verify_api_approval(endpoint, method)"
      },
      {
        "name": "rate_limit_enforcer",
        "description": "Enforce API rate limits in real-time",
        "implementation": "enforce_rate_limits(api_client, rate_limits)"
      }
    ],
    "post_task": [
      {
        "name": "completion_verification",
        "description": "Ensure all deliverables are complete",
        "implementation": "verify_task_deliverables(task_id, artifacts_created)"
      },
      {
        "name": "quality_gate_validation",
        "description": "Check quality criteria are met",
        "implementation": "validate_quality_gates(task_outputs)"
      },
      {
        "name": "api_usage_audit",
        "description": "Audit external API usage and compliance",
        "implementation": "audit_api_usage(task_api_calls)"
      }
    ]
  },
  "scope_creep_detection": {
    "max_files_per_task": 6,
    "max_lines_per_file": 500,
    "forbidden_keywords": [
      "TODO: implement domain specific",
      "HACK: temporary bypass",
      "FIXME: remove before production",
      "hardcode",
      "magic number"
    ],
    "forbidden_imports": [
      "*-beta",
      "*-alpha",
      "*-rc",
      "*-experimental",
      "devDependencies"
    ],
    "blocked_patterns": [
      "random\\.choice\\(.*\\)",
      "eval\\(",
      "exec\\(",
      "subprocess\\.call\\("
    ]
  },
  "api_rate_limits": {
    "semantic_scholar": {
      "requests_per_second": 1,
      "requests_per_minute": 60,
      "burst_allowed": false
    },
    "arxiv": {
      "requests_per_second": 3,
      "requests_per_minute": 100,
      "burst_allowed": true
    },
    "pubmed": {
      "requests_per_second": 3,
      "requests_per_minute": 180,
      "burst_allowed": true,
      "requires_email": true,
      "api_key_benefits": "10 rps"
    }
  },
  "quality_thresholds": {
    "code_coverage_min": 80,
    "complexity_max": 10,
    "duplicate_code_max": 3,
    "security_issues_max": 0,
    "performance_score_min": 8,
    "api_success_rate_min": 95
  },
  "milestone_gates": {
    "M1": {
      "required_tests": ["api_integrations", "vector_search", "search_workflow", "rate_limiting"],
      "min_coverage": 85,
      "security_scan_required": true,
      "performance_baseline_required": true,
      "api_compliance_required": true
    },
    "M2": {
      "required_tests": ["pdf_parsing", "quality_assessment", "batch_processing", "citation_analysis"],
      "min_coverage": 85,
      "integration_tests_required": true,
      "accuracy_validation_required": true
    },
    "M3": {
      "required_tests": ["hypothesis_generation", "gap_analysis", "knowledge_synthesis", "validation"],
      "min_coverage": 90,
      "quality_metrics_required": true,
      "domain_validation_required": true
    },
    "M4": {
      "required_tests": ["command_integration", "end_to_end_workflow", "subagent_coordination", "error_handling"],
      "min_coverage": 85,
      "integration_tests_required": true,
      "production_readiness_required": true
    }
  },
  "rollback_strategy": {
    "checkpoint_frequency": "every_task",
    "retention_policy": "keep_all_milestones",
    "recovery_options": [
      "rollback_to_previous_task",
      "rollback_to_milestone_start",
      "rollback_to_known_good_state"
    ],
    "validation_after_rollback": true
  },
  "external_api_monitoring": {
    "enabled_apis": ["semantic_scholar", "arxiv", "pubmed"],
    "monitoring_metrics": [
      "request_count",
      "success_rate",
      "response_time",
      "rate_limit_hits",
      "error_patterns"
    ],
    "alert_thresholds": {
      "error_rate": 5,
      "rate_limit_hits": 10,
      "response_time_ms": 5000
    }
  }
}